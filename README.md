                                                    Some Queries Examples

										-- REQUEST 1 --
            
SELECT * FROM DIM_CUSTOMER WHERE CUSTOMER = 'Atliq Exclusive' AND REGION = 'APAC';

										-- REQUEST 2 --
                        
WITH product_counts AS (
    SELECT 
        COUNT(DISTINCT CASE WHEN FGP.FISCAL_YEAR = 2020 THEN DP.PRODUCT END) AS unique_products_2020,
        COUNT(DISTINCT CASE WHEN FGP.FISCAL_YEAR = 2021 THEN DP.PRODUCT END) AS unique_products_2021
    FROM FACT_GROSS_PRICE AS FGP
    JOIN DIM_PRODUCT AS DP
      ON DP.PRODUCT_CODE = FGP.PRODUCT_CODE
    WHERE FGP.FISCAL_YEAR IN (2020, 2021)
)
SELECT 
    unique_products_2020,
    unique_products_2021,
    ROUND(((unique_products_2021 - unique_products_2020) * 100.0 / unique_products_2020), 2) AS percentage_chg
FROM product_counts;

  
										-- REQUEST 3 -- 

SELECT COUNT(DISTINCT PRODUCT) AS PRODUCTCOUNT,SEGMENT FROM DIM_PRODUCT GROUP BY SEGMENT ORDER BY PRODUCTCOUNT DESC;

										-- Request 4 -- 

SELECT 
COUNT(
DISTINCT(CASE WHEN FGP.FISCAL_YEAR = 2020 THEN DP.PRODUCT END)) AS UNIQUE_2020,
COUNT(DISTINCT(CASE WHEN FGP.FISCAL_YEAR = 2021 THEN DP.PRODUCT END)
) AS UNIQUE_2021,
(
COUNT(
DISTINCT(CASE WHEN FGP.FISCAL_YEAR = 2021 THEN DP.PRODUCT END)) 
- COUNT(DISTINCT(CASE WHEN FGP.FISCAL_YEAR = 2020 THEN DP.PRODUCT END)) 
) AS DIFFERENCE,
CONCAT(ROUND(
(COUNT(DISTINCT(CASE WHEN FGP.FISCAL_YEAR = 2021 THEN DP.PRODUCT END)) 
- COUNT(DISTINCT(CASE WHEN FGP.FISCAL_YEAR = 2020 THEN DP.PRODUCT END)))/
  COUNT(DISTINCT(CASE WHEN FGP.FISCAL_YEAR = 2020 THEN DP.PRODUCT END)),2
)*100,'%') AS 'Chg%',
SEGMENT FROM DIM_PRODUCT AS DP
JOIN FACT_GROSS_PRICE AS FGP ON 
DP.PRODUCT_CODE = FGP.PRODUCT_CODE
GROUP BY SEGMENT ORDER BY UNIQUE_2021 Asc,UNIQUE_2020 ASC LIMIT 1 ;


										-- Request 5 --

(SELECT DP.PRODUCT,FMC.PRODUCT_CODE,FMC.MANUFACTURING_COST FROM DIM_PRODUCT AS DP 
JOIN 
FACT_MANUFACTURING_COST AS FMC ON 
DP.PRODUCT_CODE = FMC.PRODUCT_CODE ORDER BY FMC.MANUFACTURING_COST DESC LIMIT 1)
UNION
(SELECT DP.PRODUCT,FMC.PRODUCT_CODE,FMC.MANUFACTURING_COST FROM DIM_PRODUCT AS DP 
JOIN 
FACT_MANUFACTURING_COST AS FMC ON 
DP.PRODUCT_CODE = FMC.PRODUCT_CODE ORDER BY FMC.MANUFACTURING_COST ASC LIMIT 1);
